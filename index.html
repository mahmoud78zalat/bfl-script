<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BFL Customer Service Helper - Enhanced</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #fefefe 0%, #f9f7f4 100%);
            min-height: 100vh;
            padding: 20px;
            color: #2c2c2c;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo-text {
            font-size: 32px;
            font-weight: 700;
            color: #2c2c2c;
            margin-bottom: 8px;
            letter-spacing: -0.5px;
        }

        .subtitle {
            color: #666;
            font-size: 16px;
            font-weight: 400;
            margin-bottom: 10px;
        }

        .status-indicator {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: #e8f5e8;
            color: #2d5a2d;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #28a745;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .main-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            gap: 25px;
        }

        .section {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #f0ede6;
        }

        .section-title {
            font-size: 18px;
            font-weight: 600;
            color: #2c2c2c;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Order ID Converter Styles */
        .converter-container {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .input-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .input-label {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .order-input, .customer-input, .country-select, .agent-input {
            padding: 14px 16px;
            border: 2px solid #e8e5de;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 500;
            color: #333;
            background: #fafaf9;
            transition: all 0.3s ease;
            letter-spacing: 0.5px;
        }

        .order-input:focus, .customer-input:focus, .country-select:focus, .agent-input:focus {
            outline: none;
            border-color: #d4af37;
            background: white;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .convert-btn {
            padding: 14px 24px;
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            letter-spacing: 0.3px;
            height: fit-content;
        }

        .convert-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.3);
        }

        .result-container {
            background: linear-gradient(135deg, #f9f7f4 0%, #f5f2eb 100%);
            border: 1px solid #e8e5de;
            border-radius: 12px;
            padding: 20px;
            margin-top: 15px;
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.4s ease;
            position: relative;
        }

        .result-container.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .result-label {
            font-size: 14px;
            color: #666;
            font-weight: 500;
        }

        .result-value {
            font-size: 28px;
            font-weight: 700;
            color: #2c2c2c;
            letter-spacing: 1px;
            font-family: 'Courier New', monospace;
            user-select: text;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .result-value:hover {
            background: rgba(212, 175, 55, 0.1);
            transform: scale(1.02);
        }

        .copy-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #f5f2eb 0%, #ede8db 100%);
            border: 1px solid #e8e5de;
            border-radius: 8px;
            color: #666;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .copy-btn:hover {
            background: linear-gradient(135deg, #ede8db 0%, #e8e5de 100%);
            border-color: #d4af37;
            color: #333;
        }

        .copy-btn.copied {
            background: linear-gradient(135deg, #d4af37 0%, #b8941f 100%);
            border-color: #d4af37;
            color: white;
        }

        /* Insert Button Styles */
        .insert-btn {
            padding: 6px 12px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 4px;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .insert-btn:hover {
            background: linear-gradient(135deg, #20c997 0%, #17a2b8 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .insert-btn.inserted {
            background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%);
        }

        /* Country Selector Styles */
        .country-fee-container {
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%);
            border: 1px solid #b3d9ff;
            border-radius: 10px;
            padding: 15px;
            margin-top: 10px;
            display: none;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.3s ease;
        }

        .country-fee-container.show {
            display: block;
            opacity: 1;
            transform: translateY(0);
        }

        .fee-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .fee-text {
            font-size: 14px;
            color: #2c5aa0;
            font-weight: 500;
        }

        /* Personalization Styles */
        .personalization-grid {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr auto;
            gap: 15px;
            align-items: end;
        }

        .language-toggle {
            display: flex;
            background: #f5f2eb;
            border-radius: 8px;
            padding: 4px;
            gap: 4px;
        }

        .lang-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: transparent;
            color: #666;
        }

        .lang-btn.active {
            background: white;
            color: #2c2c2c;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Reply Templates Styles */
        .search-bar {
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e8e5de;
            border-radius: 8px;
            font-size: 14px;
            background: #fafaf9;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #d4af37;
            background: white;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }

        .category-section {
            margin-bottom: 25px;
        }

        .category-title {
            font-size: 16px;
            font-weight: 600;
            color: #d4af37;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #f0ede6;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .replies-grid {
            display: grid;
            gap: 12px;
        }

        .reply-card {
            background: #fafaf9;
            border: 2px solid #e8e5de;
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .reply-card:hover {
            background: #f5f2eb;
            border-color: #d4af37;
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .reply-card.copied {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            border-color: #28a745;
        }

        .reply-card.copied::after {
            content: "‚úì Copied!";
            position: absolute;
            top: 10px;
            right: 15px;
            background: #28a745;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600;
        }

        .reply-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .reply-type {
            font-size: 12px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 0.3px;
        }

        .reply-lang {
            font-size: 14px;
            color: #999;
        }

        .reply-text {
            font-size: 14px;
            line-height: 1.5;
            color: #333;
            margin-bottom: 10px;
        }

        .reply-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 10px;
            border-top: 1px solid #e8e5de;
            gap: 10px;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .copy-hint {
            font-size: 11px;
            color: #999;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .copy-icon {
            width: 12px;
            height: 12px;
            opacity: 0.6;
        }

        .insert-icon {
            width: 10px;
            height: 10px;
        }

        .feedback {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            opacity: 0;
            transform: translateX(100px);
            transition: all 0.3s ease;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .feedback.show {
            opacity: 1;
            transform: translateX(0);
        }

        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin-top: 8px;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .personalization-grid {
                grid-template-columns: 1fr;
            }
            
            .converter-container {
                grid-template-columns: 1fr;
            }
            
            .main-container {
                padding: 0 10px;
            }
            
            .section {
                padding: 20px;
            }

            .action-buttons {
                flex-direction: column;
                gap: 4px;
            }
        }

        .item-input-container {
            background: #f8f6f0;
            border: 1px solid #e8e5de;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="logo-text">Brands for Less</h1>
        <p class="subtitle">Customer Service Helper Tool - Enhanced</p>
        <div class="status-indicator">
            <div class="status-dot"></div>
            Ready for Customer Support
        </div>
    </div>

    <div class="main-container">
        <!-- Order ID Converter Section -->
        <div class="section">
            <h2 class="section-title">
                üîç Order ID ‚Üí User ID Converter
            </h2>
            <div class="converter-container">
                <div class="input-group">
                    <label class="input-label" for="orderInput">Enter Order ID</label>
                    <input 
                        type="text" 
                        id="orderInput" 
                        class="order-input" 
                        placeholder="e.g., A176177000006"
                        maxlength="20"
                    >
                </div>
                
                <button class="convert-btn" onclick="convertOrderId()">
                    Convert
                </button>
            </div>
            
            <div id="resultContainer" class="result-container">
                <div class="result-header">
                    <div class="result-label">User ID</div>
                    <button id="copyBtn" class="copy-btn" onclick="copyResult()">
                        <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy
                    </button>
                </div>
                <div id="resultValue" class="result-value" onclick="copyResultValue()">-</div>
            </div>
            
            <div id="errorMessage" class="error-message" style="display: none;"></div>
        </div>

        <!-- Personalization Section -->
        <div class="section">
            <h2 class="section-title">
                üìù Agent & Customer Personalization
            </h2>
            <div class="personalization-grid">
                <div class="input-group">
                    <label class="input-label" for="agentName">Agent Name</label>
                    <input 
                        type="text" 
                        id="agentName" 
                        class="agent-input" 
                        placeholder="Enter your name..."
                        value="Mahmoud"
                        oninput="updateReplies()"
                    >
                </div>

                <div class="input-group">
                    <label class="input-label" for="customerName">Customer Name</label>
                    <input 
                        type="text" 
                        id="customerName" 
                        class="customer-input" 
                        placeholder="Enter customer name..."
                        oninput="updateReplies()"
                    >
                </div>
                
                <div class="input-group">
                    <label class="input-label" for="customerCountry">Customer Country</label>
                    <select id="customerCountry" class="country-select" onchange="updateCountryAndReplies()">
                        <option value="">-- Select Country --</option>
                        <option value="uae">UAE</option>
                        <option value="ksa">KSA</option>
                        <option value="lebanon">Lebanon</option>
                        <option value="kuwait">Kuwait</option>
                        <option value="oman">Oman</option>
                        <option value="qatar">Qatar</option>
                        <option value="bahrain">Bahrain</option>
                        <option value="singapore">Singapore</option>
                        <option value="malaysia">Malaysia</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label class="input-label">Language</label>
                    <div class="language-toggle">
                        <button class="lang-btn active" onclick="setLanguage('en')" data-lang="en">
                            üá¨üáß EN
                        </button>
                        <button class="lang-btn" onclick="setLanguage('ar')" data-lang="ar">
                            üá∏üá¶ AR
                        </button>
                    </div>
                </div>
            </div>
            
            <div id="countryFeeContainer" class="country-fee-container">
                <div class="fee-info">
                    <div class="fee-text" id="feeText">Please note that collection fee for selected country is Free</div>
                    <button class="copy-btn" onclick="copyFeeInfo()">
                        <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy
                    </button>
                </div>
            </div>
        </div>

        <!-- Reply Templates Section -->
        <div class="section">
            <h2 class="section-title">
                üí¨ Reply Templates & Helper Tool
            </h2>
            
            <div class="search-bar">
                <input 
                    type="text" 
                    id="searchInput" 
                    class="search-input" 
                    placeholder="üîç Search replies..."
                    oninput="filterReplies()"
                >
            </div>

            <div id="repliesContainer">
                <!-- Replies will be generated here -->
            </div>
        </div>

    </div>

    <div id="feedback" class="feedback">Copied!</div>

    <script>
        let currentLanguage = 'en';
        let currentCustomerName = '';
        let currentAgentName = 'Mahmoud';
        let currentCustomerCountry = '';
        let copiedReplies = new Set();
        let insertedReplies = new Set();

        // Name translation dictionary
        const nameTranslations = {
            'john': 'ÿ¨ŸàŸÜ', 'mary': 'ŸÖÿ±ŸäŸÖ', 'ahmed': 'ÿ£ÿ≠ŸÖÿØ', 'sara': 'ÿ≥ÿßÿ±ÿ©', 'sarah': 'ÿ≥ÿßÿ±ÿ©',
            'mohammed': 'ŸÖÿ≠ŸÖÿØ', 'muhammad': 'ŸÖÿ≠ŸÖÿØ', 'fatima': 'ŸÅÿßÿ∑ŸÖÿ©', 'ali': 'ÿπŸÑŸä', 'aisha': 'ÿπÿßÿ¶ÿ¥ÿ©',
            'omar': 'ÿπŸÖÿ±', 'khadija': 'ÿÆÿØŸäÿ¨ÿ©', 'hassan': 'ÿ≠ÿ≥ŸÜ', 'zainab': 'ÿ≤ŸäŸÜÿ®', 'ibrahim': 'ÿ•ÿ®ÿ±ÿßŸáŸäŸÖ',
            'amina': 'ÿ¢ŸÖŸäŸÜÿ©', 'yusuf': 'ŸäŸàÿ≥ŸÅ', 'layla': 'ŸÑŸäŸÑŸâ', 'khalid': 'ÿÆÿßŸÑÿØ', 'nour': 'ŸÜŸàÿ±',
            'adam': 'ÿ¢ÿØŸÖ', 'yasmin': 'Ÿäÿßÿ≥ŸÖŸäŸÜ', 'david': 'ÿØÿßŸàÿØ', 'michael': 'ŸÖŸäÿÆÿßÿ¶ŸäŸÑ', 'daniel': 'ÿØÿßŸÜŸäÿßŸÑ',
            'mahmoud': 'ŸÖÿ≠ŸÖŸàÿØ', 'ahmad': 'ÿ£ÿ≠ŸÖÿØ', 'hassan': 'ÿ≠ÿ≥ŸÜ', 'hussein': 'ÿ≠ÿ≥ŸäŸÜ'
        };

        // Country fee information with improved logic
        const countryFees = {
            'uae': {
                fee: 'Free',
                details: 'Free collection'
            },
            'ksa': {
                fee: 'Free',
                details: 'Free collection'
            },
            'lebanon': {
                fee: '1 USD',
                details: '1 USD (no shop available)'
            },
            'kuwait': {
                fee: '3 KWD',
                details: '3 KWD (Can also return to the branch(s) for free.)'
            },
            'oman': {
                fee: '3.10 OMR',
                details: '3.10 OMR (Can also return to the branch(s) for free.)'
            },
            'qatar': {
                fee: '20 QAR',
                details: '20 QAR (Can also return to the branch(s) for free.)'
            },
            'bahrain': {
                fee: '3 BHD',
                details: '3 BHD (Can also return to the branch(s) for free.)'
            },
            'singapore': {
                fee: 'Free',
                details: 'Free (Can also return to the branch)'
            },
            'malaysia': {
                fee: 'Free',
                details: 'Free collection'
            }
        };

        // Reply templates organized by categories
        const replyCategories = {
            greeting: {
                title: "Greeting",
                templates: {
                    welcome: {
                        en: "Hi [Customer], thank you for contacting Brands For Less. My name is [Agent], and I'm here to assist you today. üòä",
                        ar: "ŸÖÿ±ÿ≠ÿ®Ÿãÿß [Customer]ÿå ÿ¥ŸÉÿ±Ÿãÿß ŸÑÿ™ŸàÿßÿµŸÑŸÉ ŸÖÿπ ÿ®ÿ±ÿßŸÜÿØÿ≤ ŸÅŸàÿ± ŸÑŸäÿ≥. ÿßÿ≥ŸÖŸä [Agent]ÿå Ÿàÿ£ŸÜÿß ŸáŸÜÿß ŸÑŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖ. üòä"
                    }
                }
            },
            availability: {
                title: "Availability / Treasure Hunt Concept",
                templates: {
                    treasure_hunt: {
                        en: "[ItemName]At Brands For Less, we follow a \"Treasure Hunt\" concept, which means our stock changes quickly and constantly. Due to this, we are not able to check the availability of specific items. This is why sometimes items may be out of stock in our shops or online. We recommend checking back often, as new items are added daily!",
                        ar: "[ItemName]ŸÅŸä ÿ®ÿ±ÿßŸÜÿØÿ≤ ŸÅŸàÿ± ŸÑŸäÿ≥ÿå ŸÜÿ™ÿ®ÿπ ŸÖŸÅŸáŸàŸÖ \"ÿßŸÑÿ®ÿ≠ÿ´ ÿπŸÜ ÿßŸÑŸÉŸÜÿ≤\"ÿå ŸÖŸÖÿß ŸäÿπŸÜŸä ÿ£ŸÜ ŸÖÿÆÿ≤ŸàŸÜŸÜÿß Ÿäÿ™ÿ∫Ÿäÿ± ÿ®ÿ≥ÿ±ÿπÿ© Ÿàÿ®ÿßÿ≥ÿ™ŸÖÿ±ÿßÿ±. ŸÑŸáÿ∞ÿß ÿßŸÑÿ≥ÿ®ÿ®ÿå ŸÑÿß ŸÜÿ≥ÿ™ÿ∑Ÿäÿπ ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ™ŸàŸÅÿ± ŸÖŸÜÿ™ÿ¨ÿßÿ™ ŸÖÿ≠ÿØÿØÿ©. ŸÑŸáÿ∞ÿß ŸÇÿØ ÿ™ŸÉŸàŸÜ ÿ®ÿπÿ∂ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±ÿ© ŸÅŸä ŸÖÿ™ÿßÿ¨ÿ±ŸÜÿß ÿ£Ÿà ÿπÿ®ÿ± ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™. ŸÜŸÜÿµÿ≠ ÿ®ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÉÿ´Ÿäÿ±ÿßŸãÿå ÿ≠Ÿäÿ´ ÿ™Ÿèÿ∂ÿßŸÅ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿ¨ÿØŸäÿØÿ© ŸäŸàŸÖŸäÿßŸã!"
                    }
                }
            },
            return: {
                title: "Return",
                templates: {
                    return_policy: {
                        en: "You can return items within 14 days of purchase with the original receipt, [Customer]. Would you like me to check your order details?",
                        ar: "ŸäŸÖŸÉŸÜŸÉ ÿ•ÿ±ÿ¨ÿßÿπ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿÆŸÑÿßŸÑ 14 ŸäŸàŸÖ ŸÖŸÜ ÿßŸÑÿ¥ÿ±ÿßÿ° ŸÖÿπ ÿßŸÑÿ•ŸäÿµÿßŸÑ ÿßŸÑÿ£ÿµŸÑŸäÿå [Customer]. ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖŸÜŸä ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ™ŸÅÿßÿµŸäŸÑ ÿ∑ŸÑÿ®ŸÉÿü"
                    },
                    return_process: {
                        en: "To process your return [Customer], please visit any of our branches with your receipt and the items. The refund will be processed within 7-14 working days.",
                        ar: "ŸÑŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ•ÿ±ÿ¨ÿßÿπ [Customer]ÿå Ÿäÿ±ÿ¨Ÿâ ÿ≤Ÿäÿßÿ±ÿ© ÿ£Ÿä ŸÖŸÜ ŸÅÿ±ŸàÿπŸÜÿß ŸÖÿπ ÿßŸÑÿ•ŸäÿµÿßŸÑ ŸàÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™. ÿ≥Ÿäÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ÿÆŸÑÿßŸÑ 7-14 ŸäŸàŸÖ ÿπŸÖŸÑ."
                    }
                }
            },
            order_status: {
                title: "Order Status",
                templates: {
                    checking_order: {
                        en: "Let me check the status of your order right now, [Customer]. Please give me a moment.",
                        ar: "ÿØÿπŸÜŸä ÿ£ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ≠ÿßŸÑÿ© ÿ∑ŸÑÿ®ŸÉ ÿßŸÑÿ¢ŸÜ Ÿäÿß [Customer]. ÿ£ÿ±ÿ¨Ÿà ŸÖŸÜŸÉ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ± ŸÑÿ≠ÿ∏ÿ©."
                    },
                    order_shipped: {
                        en: "Great news [Customer]! Your order has been shipped and is on its way to you. You should receive it within 2-3 business days.",
                        ar: "ÿ£ÿÆÿ®ÿßÿ± ÿ±ÿßÿ¶ÿπÿ© [Customer]! ÿ™ŸÖ ÿ¥ÿ≠ŸÜ ÿ∑ŸÑÿ®ŸÉ ŸàŸáŸà ŸÅŸä ÿ∑ÿ±ŸäŸÇŸá ÿ•ŸÑŸäŸÉ. ÿ≥ÿ™ÿ≥ÿ™ŸÑŸÖŸá ÿÆŸÑÿßŸÑ 2-3 ÿ£ŸäÿßŸÖ ÿπŸÖŸÑ."
                    }
                }
            },
            invoice_request: {
                title: "Invoice Request",
                templates: {
                    invoice_info: {
                        en: "I can help you with your invoice, [Customer]. Could you please provide me with your order number?",
                        ar: "ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ®ÿßŸÑŸÅÿßÿ™Ÿàÿ±ÿ©ÿå [Customer]. ŸáŸÑ ŸäŸÖŸÉŸÜŸÉ ÿ™ÿ≤ŸàŸäÿØŸä ÿ®ÿ±ŸÇŸÖ ÿßŸÑÿ∑ŸÑÿ®ÿü"
                    }
                }
            },
            canceled_quality: {
                title: "Canceled (Quality)",
                templates: {
                    quality_issue: {
                        en: "I sincerely apologize for the quality issue with your order, [Customer]. We take this very seriously and will process a full refund immediately.",
                        ar: "ÿ£ÿπÿ™ÿ∞ÿ± ÿ®ÿµÿØŸÇ ÿπŸÜ ŸÖÿ¥ŸÉŸÑÿ© ÿßŸÑÿ¨ŸàÿØÿ© ŸÅŸä ÿ∑ŸÑÿ®ŸÉ Ÿäÿß [Customer]. ŸÜÿ≠ŸÜ ŸÜÿ£ÿÆÿ∞ Ÿáÿ∞ÿß ÿßŸÑÿ£ŸÖÿ± ÿ®ÿ¨ÿØŸäÿ© ŸÉÿ®Ÿäÿ±ÿ© Ÿàÿ≥ŸÜŸÇŸàŸÖ ÿ®ŸÖÿπÿßŸÑÿ¨ÿ© ÿßÿ≥ÿ™ÿ±ÿØÿßÿØ ŸÉÿßŸÖŸÑ ŸÅŸàÿ±Ÿãÿß."
                    }
                }
            },
            payment_failure: {
                title: "Payment Failure",
                templates: {
                    payment_failed: {
                        en: "It seems there was an issue with your payment, [Customer]. Please try using a different payment method or contact your bank.",
                        ar: "Ÿäÿ®ÿØŸà ÿ£ŸÜ ŸáŸÜÿßŸÉ ŸÖÿ¥ŸÉŸÑÿ© ŸÅŸä ÿßŸÑÿØŸÅÿπÿå [Customer]. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ÿ®ÿ∑ÿ±ŸäŸÇÿ© ÿØŸÅÿπ ÿ£ÿÆÿ±Ÿâ ÿ£Ÿà ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ®ŸÜŸÉ."
                    }
                }
            },
            out_of_stock: {
                title: "Out of Stock",
                templates: {
                    item_unavailable: {
                        en: "Unfortunately [Customer], this item is currently out of stock. Would you like me to notify you when it becomes available again?",
                        ar: "ŸÑŸÑÿ£ÿ≥ŸÅ [Customer]ÿå Ÿáÿ∞ÿß ÿßŸÑŸÖŸÜÿ™ÿ¨ ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ± ÿ≠ÿßŸÑŸäŸãÿß. ŸáŸÑ ÿ™ÿ±ŸäÿØ ŸÖŸÜŸä ÿ•ÿ¥ÿπÿßÿ±ŸÉ ÿπŸÜÿØŸÖÿß Ÿäÿµÿ®ÿ≠ ŸÖÿ™ŸàŸÅÿ±Ÿãÿß ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâÿü"
                    }
                }
            },
            adding_points: {
                title: "Adding Points Case",
                templates: {
                    points_added: {
                        en: "I've successfully added the points to your account, [Customer]. You should see them reflected within 24 hours.",
                        ar: "ŸÑŸÇÿØ ÿ£ÿ∂ŸÅÿ™ ÿßŸÑŸÜŸÇÿßÿ∑ ÿ®ŸÜÿ¨ÿßÿ≠ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉÿå [Customer]. ÿ≥ÿ™ÿ±ÿßŸáÿß ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ©."
                    }
                }
            },
            user_idle: {
                title: "User Idle Replies",
                templates: {
                    idle_check: {
                        en: "Are you still there, [Customer]? I'm here to help if you need anything else.",
                        ar: "ŸáŸÑ ŸÖÿß ÿ≤ŸÑÿ™ ŸáŸÜÿßŸÉÿå [Customer]ÿü ÿ£ŸÜÿß ŸáŸÜÿß ŸÑŸÑŸÖÿ≥ÿßÿπÿØÿ© ÿ•ÿ∞ÿß ŸÉŸÜÿ™ ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ£Ÿä ÿ¥Ÿäÿ° ÿ¢ÿÆÿ±."
                    },
                    idle_waiting: {
                        en: "I'm still here with you [Customer]. Please let me know if you have any other questions.",
                        ar: "ŸÖÿß ÿ≤ŸÑÿ™ ŸáŸÜÿß ŸÖÿπŸÉ [Customer]. ÿ£ÿ±ÿ¨Ÿà ÿ•ÿπŸÑÿßŸÖŸä ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÑÿØŸäŸÉ ÿ£Ÿä ÿ£ÿ≥ÿ¶ŸÑÿ© ÿ£ÿÆÿ±Ÿâ."
                    }
                }
            },
            closing_help: {
                title: "Closing & Additional Assistance",
                templates: {
                    closing_offer: {
                        en: "Thank you [Customer]! If you need any further assistance, please don't hesitate to reach out. Have a wonderful day!",
                        ar: "ÿ¥ŸÉÿ±Ÿãÿß ŸÑŸÉ [Customer]! ÿ•ÿ∞ÿß ŸÉŸÜÿ™ ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ£Ÿä ŸÖÿ≥ÿßÿπÿØÿ© ÿ•ÿ∂ÿßŸÅŸäÿ©ÿå ŸÑÿß ÿ™ÿ™ÿ±ÿØÿØ ŸÅŸä ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÜÿß. ÿ£ÿ™ŸÖŸÜŸâ ŸÑŸÉ ŸäŸàŸÖŸãÿß ÿ±ÿßÿ¶ÿπŸãÿß!"
                    },
                    additional_assistance: {
                        en: "May I ask if there is anything else I can assist you with?",
                        ar: "ŸáŸÑ ŸäŸÖŸÉŸÜŸÜŸä ÿ£ŸÜ ÿ£ÿ≥ÿ£ŸÑ ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸáŸÜÿßŸÉ ÿ£Ÿä ÿ¥Ÿäÿ° ÿ¢ÿÆÿ± ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ®Ÿáÿü"
                    },
                    further_assistance: {
                        en: "If you have any questions or need further assistance, please feel free to reach out.",
                        ar: "ÿ•ÿ∞ÿß ŸÉÿßŸÜ ŸÑÿØŸäŸÉ ÿ£Ÿä ÿ£ÿ≥ÿ¶ŸÑÿ© ÿ£Ÿà ÿ™ÿ≠ÿ™ÿßÿ¨ ŸÖÿ≥ÿßÿπÿØÿ© ÿ•ÿ∂ÿßŸÅŸäÿ©ÿå ŸÑÿß ÿ™ÿ™ÿ±ÿØÿØ ŸÅŸä ÿßŸÑÿ™ŸàÿßÿµŸÑ ŸÖÿπŸÜÿß."
                    },
                    inquiry_coverage: {
                        en: "I want to make sure your inquiry is covered. Is there anything else I can assist you with?",
                        ar: "ÿ£ÿ±ŸäÿØ ÿßŸÑÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿ£ŸÜ ÿßÿ≥ÿ™ŸÅÿ≥ÿßÿ±ŸÉ ŸÖÿ∫ÿ∑Ÿâ. ŸáŸÑ ŸáŸÜÿßŸÉ ÿ£Ÿä ÿ¥Ÿäÿ° ÿ¢ÿÆÿ± ŸäŸÖŸÉŸÜŸÜŸä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿ®Ÿáÿü"
                    },
                    pleasure_to_assist: {
                        en: "You're more than welcome. It's my pleasure to assist you. Thank you for giving me the time to help you today.",
                        ar: "ÿ£ŸáŸÑÿßŸã Ÿàÿ≥ŸáŸÑÿßŸã ÿ®ŸÉ. ŸÖŸÜ ÿØŸàÿßÿπŸä ÿ≥ÿ±Ÿàÿ±Ÿä ŸÖÿ≥ÿßÿπÿØÿ™ŸÉ. ÿ¥ŸÉÿ±Ÿãÿß ŸÑŸÉ ÿπŸÑŸâ ÿ•ÿπÿ∑ÿßÿ¶Ÿä ÿßŸÑŸàŸÇÿ™ ŸÑŸÖÿ≥ÿßÿπÿØÿ™ŸÉ ÿßŸÑŸäŸàŸÖ."
                    }
                }
            },
            closing_hour: {
                title: "Closing Idle After 1 Hour",
                templates: {
                    session_timeout: {
                        en: "I haven't heard from you in a while, [Customer]. I'll be closing this chat now, but feel free to start a new conversation anytime you need help!",
                        ar: "ŸÑŸÖ ÿ£ÿ≥ŸÖÿπ ŸÖŸÜŸÉ ŸÖŸÜÿ∞ ŸÅÿ™ÿ±ÿ©ÿå [Customer]. ÿ≥ÿ£ŸÇŸàŸÖ ÿ®ÿ•ÿ∫ŸÑÿßŸÇ Ÿáÿ∞Ÿá ÿßŸÑŸÖÿ≠ÿßÿØÿ´ÿ© ÿßŸÑÿ¢ŸÜÿå ŸÑŸÉŸÜ ŸÑÿß ÿ™ÿ™ÿ±ÿØÿØ ŸÅŸä ÿ®ÿØÿ° ŸÖÿ≠ÿßÿØÿ´ÿ© ÿ¨ÿØŸäÿØÿ© ŸÅŸä ÿ£Ÿä ŸàŸÇÿ™ ÿ™ÿ≠ÿ™ÿßÿ¨ ŸÅŸäŸá ŸÑŸÑŸÖÿ≥ÿßÿπÿØÿ©!"
                    }
                }
            },
            rating_request: {
                title: "Cast Ending & Asking for Customer Rating",
                templates: {
                    rate_service: {
                        en: "Thank you for choosing Brands for Less, [Customer]! Before we end, could you please take a moment to rate my assistance today? Your feedback helps us improve our service.",
                        ar: "ÿ¥ŸÉÿ±Ÿãÿß ŸÑÿßÿÆÿ™Ÿäÿßÿ±ŸÉ ÿ®ÿ±ÿßŸÜÿØÿ≤ ŸÅŸàÿ± ŸÑŸäÿ≥ÿå [Customer]! ŸÇÿ®ŸÑ ÿ£ŸÜ ŸÜŸÜŸáŸäÿå ŸáŸÑ ŸäŸÖŸÉŸÜŸÉ ÿ™ŸÇŸäŸäŸÖ ŸÖÿ≥ÿßÿπÿØÿ™Ÿä ÿßŸÑŸäŸàŸÖÿü ŸÖŸÑÿßÿ≠ÿ∏ÿßÿ™ŸÉ ÿ™ÿ≥ÿßÿπÿØŸÜÿß ÿπŸÑŸâ ÿ™ÿ≠ÿ≥ŸäŸÜ ÿÆÿØŸÖÿ™ŸÜÿß."
                    }
                }
            }
        };

        // Order ID Converter Functions
        function convertOrderId() {
            const input = document.getElementById('orderInput');
            const resultContainer = document.getElementById('resultContainer');
            const resultValue = document.getElementById('resultValue');
            const errorMessage = document.getElementById('errorMessage');
            
            errorMessage.style.display = 'none';
            
            const orderId = input.value.trim();
            
            if (!orderId) {
                showError('Please enter an Order ID');
                return;
            }
            
            // Validate: must start with letter + at least 12 digits
            if (!/^[A-Za-z]\d{12,}$/.test(orderId)) {
                showError('Order ID must start with a letter followed by at least 12 digits (e.g., A176177000006)');
                return;
            }
            
            // Remove first letter
            let processed = orderId.substring(1);
            
            // Remove last 5 digits
            processed = processed.substring(0, processed.length - 5);
            
            if (!processed) {
                showError('Unable to generate User ID from this Order ID');
                return;
            }
            
            resultValue.textContent = processed;
            resultContainer.style.display = 'block';
            setTimeout(() => {
                resultContainer.classList.add('show');
            }, 10);
            
            resultValue.style.transform = 'scale(1.05)';
            setTimeout(() => {
                resultValue.style.transform = 'scale(1)';
            }, 200);
        }

        function copyResult() {
            const resultValue = document.getElementById('resultValue');
            const copyBtn = document.getElementById('copyBtn');
            const textToCopy = resultValue.textContent;
            
            if (textToCopy === '-') return;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                copyBtn.classList.add('copied');
                copyBtn.innerHTML = `
                    <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 6L9 17l-5-5"></path>
                    </svg>
                    Copied!
                `;
                
                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyBtn.innerHTML = `
                        <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                            <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                        </svg>
                        Copy
                    `;
                }, 1500);
            });
        }

        function copyResultValue() {
            const resultValue = document.getElementById('resultValue');
            const textToCopy = resultValue.textContent;
            
            if (textToCopy === '-') return;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                resultValue.style.background = 'linear-gradient(135deg, #d4af37 0%, #b8941f 100%)';
                resultValue.style.color = 'white';
                
                showFeedback('User ID Copied!');
                
                setTimeout(() => {
                    resultValue.style.background = '';
                    resultValue.style.color = '#2c2c2c';
                }, 1500);
            });
        }

        function showError(message) {
            const errorMessage = document.getElementById('errorMessage');
            const resultContainer = document.getElementById('resultContainer');
            
            errorMessage.textContent = message;
            errorMessage.style.display = 'block';
            resultContainer.classList.remove('show');
            resultContainer.style.display = 'none';
        }

        // Country Fee Functions
        function updateCountryAndReplies() {
            const countrySelect = document.getElementById('customerCountry');
            const feeContainer = document.getElementById('countryFeeContainer');
            const feeText = document.getElementById('feeText');
            
            currentCustomerCountry = countrySelect.value;
            
            if (countrySelect.value) {
                const countryData = countryFees[countrySelect.value];
                feeText.textContent = `Please note that collection fee for ${countrySelect.options[countrySelect.selectedIndex].text} is ${countryData.fee}`;
                
                feeContainer.style.display = 'block';
                setTimeout(() => {
                    feeContainer.classList.add('show');
                }, 10);
            } else {
                feeContainer.classList.remove('show');
                setTimeout(() => {
                    feeContainer.style.display = 'none';
                }, 300);
            }
            
            // Update replies when country changes
            updateReplies();
        }

        function copyFeeInfo() {
            const feeText = document.getElementById('feeText').textContent;
            navigator.clipboard.writeText(feeText).then(() => {
                showFeedback('Fee Info Copied!');
            });
        }

        // Language and Personalization Functions
        function setLanguage(lang) {
            currentLanguage = lang;
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            document.querySelector(`[data-lang="${lang}"]`).classList.add('active');
            updateReplies();
        }

        function translateName(name) {
            if (currentLanguage === 'ar' && name) {
                const lowerName = name.toLowerCase().trim();
                return nameTranslations[lowerName] || name;
            }
            return name;
        }

        function updateReplies() {
            const customerName = document.getElementById('customerName').value.trim();
            const agentName = document.getElementById('agentName').value.trim();
            
            currentCustomerName = customerName;
            currentAgentName = agentName;
            
            // Reset copied states when name changes
            copiedReplies.clear();
            insertedReplies.clear();
            
            const translatedCustomerName = translateName(customerName) || '[Customer]';
            const translatedAgentName = translateName(agentName) || '[Agent]';
            const container = document.getElementById('repliesContainer');
            
            container.innerHTML = '';
            
            // Generate replies by category
            Object.entries(replyCategories).forEach(([categoryKey, category]) => {
                const categoryDiv = document.createElement('div');
                categoryDiv.className = 'category-section';
                categoryDiv.innerHTML = `<div class="category-title">${category.title}</div>`;
                
                const repliesGrid = document.createElement('div');
                repliesGrid.className = 'replies-grid';
                
                // Add item name input for availability section
                if (categoryKey === 'availability') {
                    const itemInputDiv = document.createElement('div');
                    itemInputDiv.className = 'item-input-container';
                    itemInputDiv.innerHTML = `
                        <div class="input-group" style="margin-bottom: 15px;">
                            <label class="input-label" for="itemNameInput">Item Name (Optional)</label>
                            <input 
                                type="text" 
                                id="itemNameInput" 
                                class="customer-input" 
                                placeholder="e.g., Nike Air Max shoes (if customer asked about specific item)..."
                                oninput="updateAvailabilityReply()"
                                style="font-size: 14px; padding: 10px 14px;"
                            >
                        </div>
                    `;
                    categoryDiv.appendChild(itemInputDiv);
                }
                
                Object.entries(category.templates).forEach(([templateKey, template]) => {
                    let replyText = template[currentLanguage]
                        .replace(/\[Customer\]/g, translatedCustomerName)
                        .replace(/\[Agent\]/g, translatedAgentName);
                    
                    // Handle item name replacement for availability section
                    if (categoryKey === 'availability') {
                        const itemName = document.getElementById('itemNameInput')?.value.trim() || '';
                        const itemPrefix = itemName ? `Regarding ${itemName}: ` : '';
                        replyText = replyText.replace('[ItemName]', itemPrefix);
                    }
                    
                    const replyElement = document.createElement('div');
                    replyElement.className = 'reply-card';
                    replyElement.dataset.category = categoryKey;
                    replyElement.dataset.template = templateKey;
                    
                    replyElement.innerHTML = `
                        <div class="reply-header">
                            <div class="reply-type">${templateKey.replace(/_/g, ' ')}</div>
                            <div class="reply-lang">${currentLanguage === 'en' ? 'üá¨üáß' : 'üá∏üá¶'}</div>
                        </div>
                        <div class="reply-text">${replyText}</div>
                        <div class="reply-actions">
                            <div class="copy-hint">
                                <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                    <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                </svg>
                                Click to copy
                            </div>
                            <div class="action-buttons">
                                <button class="copy-btn" onclick="copyReply('${replyText.replace(/'/g, "\\'")}', '${templateKey}', this.closest('.reply-card'))">
                                    <svg class="copy-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                        <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
                                    </svg>
                                    Copy
                                </button>
                                <button class="insert-btn" onclick="insertToVerloop('${replyText.replace(/'/g, "\\'")}', '${templateKey}', this)">
                                    <svg class="insert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M12 5v14m-7-7h14"></path>
                                    </svg>
                                    Insert
                                </button>
                            </div>
                        </div>
                    `;
                    
                    repliesGrid.appendChild(replyElement);
                });
                
                categoryDiv.appendChild(repliesGrid);
                container.appendChild(categoryDiv);
            });
        }

        // Add new function to update availability reply when item name changes
        function updateAvailabilityReply() {
            const itemInput = document.getElementById('itemNameInput');
            const availabilityCard = document.querySelector('[data-category="availability"] .reply-card');
            
            if (itemInput && availabilityCard) {
                const customerName = document.getElementById('customerName').value.trim();
                const agentName = document.getElementById('agentName').value.trim();
                const translatedCustomerName = translateName(customerName) || '[Customer]';
                const translatedAgentName = translateName(agentName) || '[Agent]';
                const itemName = itemInput.value.trim();
                const itemPrefix = itemName ? `Regarding ${itemName}: ` : '';
                
                let replyText = replyCategories.availability.templates.treasure_hunt[currentLanguage]
                    .replace(/\[Customer\]/g, translatedCustomerName)
                    .replace(/\[Agent\]/g, translatedAgentName)
                    .replace('[ItemName]', itemPrefix);
                
                availabilityCard.querySelector('.reply-text').textContent = replyText;
                
                // Update action buttons
                const copyBtn = availabilityCard.querySelector('.copy-btn');
                const insertBtn = availabilityCard.querySelector('.insert-btn');
                
                copyBtn.onclick = () => copyReply(replyText, 'treasure_hunt', availabilityCard);
                insertBtn.onclick = () => insertToVerloop(replyText, 'treasure_hunt', insertBtn);
                
                // Reset copied state
                availabilityCard.classList.remove('copied');
                insertBtn.classList.remove('inserted');
            }
        }

        function copyReply(text, templateKey, cardElement) {
            navigator.clipboard.writeText(text).then(() => {
                // Mark as copied
                cardElement.classList.add('copied');
                copiedReplies.add(templateKey);
                
                // Show feedback
                showFeedback('Copied!');
            }).catch(err => {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                
                cardElement.classList.add('copied');
                copiedReplies.add(templateKey);
                showFeedback('Copied!');
            });
        }

        function insertToVerloop(text, templateKey, buttonElement) {
            // Simulate Verloop integration
            // In a real implementation, this would integrate with Verloop's API
            
            try {
                // Copy to clipboard as fallback
                navigator.clipboard.writeText(text);
                
                // Mark as inserted
                buttonElement.classList.add('inserted');
                buttonElement.innerHTML = `
                    <svg class="insert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M20 6L9 17l-5-5"></path>
                    </svg>
                    Inserted
                `;
                
                insertedReplies.add(templateKey);
                showFeedback('Inserted to Verloop!');
                
                // Reset button after 2 seconds
                setTimeout(() => {
                    buttonElement.classList.remove('inserted');
                    buttonElement.innerHTML = `
                        <svg class="insert-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 5v14m-7-7h14"></path>
                        </svg>
                        Insert
                    `;
                }, 2000);
                
            } catch (error) {
                showFeedback('Insert failed - copied to clipboard instead');
                console.error('Verloop integration error:', error);
            }
        }

        function filterReplies() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categories = document.querySelectorAll('.category-section');
            
            categories.forEach(category => {
                const replies = category.querySelectorAll('.reply-card');
                let hasVisibleReplies = false;
                
                replies.forEach(reply => {
                    const templateKey = reply.dataset.template.toLowerCase();
                    const text = reply.querySelector('.reply-text').textContent.toLowerCase();
                    const categoryTitle = category.querySelector('.category-title').textContent.toLowerCase();
                    
                    if (templateKey.includes(searchTerm) || text.includes(searchTerm) || categoryTitle.includes(searchTerm)) {
                        reply.style.display = 'block';
                        hasVisibleReplies = true;
                    } else {
                        reply.style.display = 'none';
                    }
                });
                
                // Hide category if no replies match
                category.style.display = hasVisibleReplies ? 'block' : 'none';
            });
        }

        function showFeedback(message) {
            const feedback = document.getElementById('feedback');
            feedback.textContent = message;
            feedback.classList.add('show');
            
            setTimeout(() => {
                feedback.classList.remove('show');
            }, 2000);
        }

        // Event Listeners
        document.getElementById('orderInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                convertOrderId();
            }
        });

        document.getElementById('orderInput').addEventListener('input', function() {
            const errorMessage = document.getElementById('errorMessage');
            const resultContainer = document.getElementById('resultContainer');
            
            errorMessage.style.display = 'none';
            if (!this.value.trim()) {
                resultContainer.classList.remove('show');
                resultContainer.style.display = 'none';
            }
        });

        // Initialize
        updateReplies();
    </script>
</body>
</html>
